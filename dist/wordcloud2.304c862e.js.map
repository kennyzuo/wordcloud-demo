{"version":3,"sources":["wordcloud2.js"],"names":["window","setImmediate","setupSetImmediate","msSetImmediate","webkitSetImmediate","mozSetImmediate","oSetImmediate","setupSetZeroTimeout","postMessage","addEventListener","callbacks","undefined","message","setZeroTimeout","callback","id","length","push","toString","setZeroTimeoutMessage","evt","data","substr","stopImmediatePropagation","parseInt","clearImmediate","clearZeroTimeout","setImmediateFallback","fn","setTimeout","setupClearImmediate","msClearImmediate","webkitClearImmediate","mozClearImmediate","oClearImmediate","clearImmediateFallback","timer","clearTimeout","global","isSupported","canvas","document","createElement","getContext","ctx","getImageData","fillText","Array","prototype","some","minFontSize","getMinFontSize","size","hanWidth","mWidth","font","measureText","width","getItemExtraData","item","isArray","itemCopy","slice","splice","shuffleArray","arr","j","x","i","Math","floor","random","WordCloud","elements","options","timerId","Date","now","forEach","el","getElementById","Error","tagName","appendChild","settings","list","fontFamily","fontWeight","color","minSize","weightFactor","clearCanvas","backgroundColor","gridSize","drawOutOfBound","shrinkToFit","origin","drawMask","maskColor","maskGapWidth","wait","abortThreshold","abort","noop","minRotation","PI","maxRotation","rotationSteps","shuffle","rotateRatio","shape","ellipticity","classes","hover","click","key","factor","pt","shapeCardioid","theta","sin","shapeSquare","thetaPrime","cos","min","abs","shapeTriangle","sqrt","shapePentagon","shapeStar","max","g","maskRectWidth","rotationRange","grid","ngx","ngy","center","maxRadius","escapeTime","getTextColor","randomHslColor","toFixed","getRandomDarkColor","getRandomLightColor","getTextFontWeight","getTextClasses","interactive","infoGrid","hovered","getInfoGridFromMouseTouchEvent","currentTarget","rect","getBoundingClientRect","clientX","clientY","touches","eventX","left","eventY","top","y","height","wordcloudhover","info","dimension","wordcloudclick","preventDefault","pointsAtRadius","getPointsAtRadius","radius","T","t","points","rx","exceedTime","getTime","getRotateDeg","getTextInfo","word","weight","rotateDeg","extraDataArray","debug","fontSize","mu","calculateScaleFactor","fcanvas","fctx","willReadFrequently","fw","fh","boxWidth","boxHeight","fgw","ceil","fgh","fillTextOffsetX","fillTextOffsetY","cgh","cgw","setAttribute","body","save","scale","translate","rotate","fillStyle","textBaseline","imageData","strokeRect","restore","occupied","gx","gy","bounds","singleGridLoop","fillRect","gw","gh","fillTextWidth","fillTextHeight","canFitText","px","py","drawText","distance","attributes","span","transformRule","styleRules","position","display","lineHeight","whiteSpace","transform","webkitTransform","msTransform","transformOrigin","webkitTransformOrigin","msTransformOrigin","textContent","cssProp","style","attribute","className","fillGridAt","updateGrid","w","h","putWord","r","tryToPutWordAtPoint","gxy","concat","drawn","sendEvent","type","cancelable","details","event","CustomEvent","detail","dispatchEvent","start","clearRect","bctx","bgPixel","webkitTapHighlightColor","stopInteraction","removeEventListener","loopingFunction","stoppingFunction","listener","anotherWordCloudStart","loop","canceled","stop","define","amd","module","exports"],"mappings":"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","file":"wordcloud2.304c862e.js","sourceRoot":"..","sourcesContent":["/*!\n * wordcloud2.js\n * http://timdream.org/wordcloud2.js/\n *\n * Copyright 2011 - 2019 Tim Guan-tin Chien and contributors.\n * Released under the MIT license\n */\n\n'use strict'\n\n// setImmediate\nif (!window.setImmediate) {\n  window.setImmediate = (function setupSetImmediate () {\n    return window.msSetImmediate ||\n    window.webkitSetImmediate ||\n    window.mozSetImmediate ||\n    window.oSetImmediate ||\n    (function setupSetZeroTimeout () {\n      if (!window.postMessage || !window.addEventListener) {\n        return null\n      }\n\n      var callbacks = [undefined]\n      var message = 'zero-timeout-message'\n\n      // Like setTimeout, but only takes a function argument.  There's\n      // no time argument (always zero) and no arguments (you have to\n      // use a closure).\n      var setZeroTimeout = function setZeroTimeout (callback) {\n        var id = callbacks.length\n        callbacks.push(callback)\n        window.postMessage(message + id.toString(36), '*')\n\n        return id\n      }\n\n      window.addEventListener('message', function setZeroTimeoutMessage (evt) {\n        // Skipping checking event source, retarded IE confused this window\n        // object with another in the presence of iframe\n        if (typeof evt.data !== 'string' ||\n            evt.data.substr(0, message.length) !== message/* ||\n            evt.source !== window */) {\n          return\n        }\n\n        evt.stopImmediatePropagation()\n\n        var id = parseInt(evt.data.substr(message.length), 36)\n        if (!callbacks[id]) {\n          return\n        }\n\n        callbacks[id]()\n        callbacks[id] = undefined\n      }, true)\n\n      /* specify clearImmediate() here since we need the scope */\n      window.clearImmediate = function clearZeroTimeout (id) {\n        if (!callbacks[id]) {\n          return\n        }\n\n        callbacks[id] = undefined\n      }\n\n      return setZeroTimeout\n    })() ||\n    // fallback\n    function setImmediateFallback (fn) {\n      window.setTimeout(fn, 0)\n    }\n  })()\n}\n\nif (!window.clearImmediate) {\n  window.clearImmediate = (function setupClearImmediate () {\n    return window.msClearImmediate ||\n    window.webkitClearImmediate ||\n    window.mozClearImmediate ||\n    window.oClearImmediate ||\n    // \"clearZeroTimeout\" is implement on the previous block ||\n    // fallback\n    function clearImmediateFallback (timer) {\n      window.clearTimeout(timer)\n    }\n  })()\n}\n\n(function (global) {\n  // Check if WordCloud can run on this browser\n  var isSupported = (function isSupported () {\n    var canvas = document.createElement('canvas')\n    if (!canvas || !canvas.getContext) {\n      return false\n    }\n\n    var ctx = canvas.getContext('2d')\n    if (!ctx) {\n      return false\n    }\n    if (!ctx.getImageData) {\n      return false\n    }\n    if (!ctx.fillText) {\n      return false\n    }\n\n    if (!Array.prototype.some) {\n      return false\n    }\n    if (!Array.prototype.push) {\n      return false\n    }\n\n    return true\n  }())\n\n  // Find out if the browser impose minium font size by\n  // drawing small texts on a canvas and measure it's width.\n  var minFontSize = (function getMinFontSize () {\n    if (!isSupported) {\n      return\n    }\n\n    var ctx = document.createElement('canvas').getContext('2d')\n\n    // start from 20\n    var size = 20\n\n    // two sizes to measure\n    var hanWidth, mWidth\n\n    while (size) {\n      ctx.font = size.toString(10) + 'px sans-serif'\n      if ((ctx.measureText('\\uFF37').width === hanWidth) &&\n          (ctx.measureText('m').width) === mWidth) {\n        return (size + 1)\n      }\n\n      hanWidth = ctx.measureText('\\uFF37').width\n      mWidth = ctx.measureText('m').width\n\n      size--\n    }\n\n    return 0\n  })()\n\n  var getItemExtraData = function (item) {\n    if (Array.isArray(item)) {\n      var itemCopy = item.slice()\n      // remove data we already have (word and weight)\n      itemCopy.splice(0, 2)\n      return itemCopy\n    } else {\n      return []\n    }\n  }\n\n  // Based on http://jsfromhell.com/array/shuffle\n  var shuffleArray = function shuffleArray (arr) {\n    for (var j, x, i = arr.length; i;) {\n      j = Math.floor(Math.random() * i)\n      x = arr[--i]\n      arr[i] = arr[j]\n      arr[j] = x\n    }\n    return arr\n  }\n\n  var timer = {};\n  var WordCloud = function WordCloud (elements, options) {\n    if (!isSupported) {\n      return\n    }\n\n    var timerId = Math.floor(Math.random() * Date.now())\n\n    if (!Array.isArray(elements)) {\n      elements = [elements]\n    }\n\n    elements.forEach(function (el, i) {\n      if (typeof el === 'string') {\n        elements[i] = document.getElementById(el)\n        if (!elements[i]) {\n          throw new Error('The element id specified is not found.')\n        }\n      } else if (!el.tagName && !el.appendChild) {\n        throw new Error('You must pass valid HTML elements, or ID of the element.')\n      }\n    })\n\n    /* Default values to be overwritten by options object */\n    var settings = {\n      list: [],\n      fontFamily: '\"Trebuchet MS\", \"Heiti TC\", \"微軟正黑體\", ' +\n                  '\"Arial Unicode MS\", \"Droid Fallback Sans\", sans-serif',\n      fontWeight: 'normal',\n      color: 'random-dark',\n      minSize: 0, // 0 to disable\n      weightFactor: 1,\n      clearCanvas: true,\n      backgroundColor: '#fff', // opaque white = rgba(255, 255, 255, 1)\n\n      gridSize: 8,\n      drawOutOfBound: false,\n      shrinkToFit: false,\n      origin: null,\n\n      drawMask: false,\n      maskColor: 'rgba(255,0,0,0.3)',\n      maskGapWidth: 0.3,\n\n      wait: 0,\n      abortThreshold: 0, // disabled\n      abort: function noop () {},\n\n      minRotation: -Math.PI / 2,\n      maxRotation: Math.PI / 2,\n      rotationSteps: 0,\n\n      shuffle: true,\n      rotateRatio: 0.1,\n\n      shape: 'circle',\n      ellipticity: 0.65,\n\n      classes: null,\n\n      hover: null,\n      click: null\n    }\n\n    if (options) {\n      for (var key in options) {\n        if (key in settings) {\n          settings[key] = options[key]\n        }\n      }\n    }\n\n    /* Convert weightFactor into a function */\n    if (typeof settings.weightFactor !== 'function') {\n      var factor = settings.weightFactor\n      settings.weightFactor = function weightFactor (pt) {\n        return pt * factor // in px\n      }\n    }\n\n    /* Convert shape into a function */\n    if (typeof settings.shape !== 'function') {\n      switch (settings.shape) {\n        case 'circle':\n        /* falls through */\n        default:\n          // 'circle' is the default and a shortcut in the code loop.\n          settings.shape = 'circle'\n          break\n\n        case 'cardioid':\n          settings.shape = function shapeCardioid (theta) {\n            return 1 - Math.sin(theta)\n          }\n          break\n\n          /*\n          To work out an X-gon, one has to calculate \"m\",\n          where 1/(cos(2*PI/X)+m*sin(2*PI/X)) = 1/(cos(0)+m*sin(0))\n          http://www.wolframalpha.com/input/?i=1%2F%28cos%282*PI%2FX%29%2Bm*sin%28\n          2*PI%2FX%29%29+%3D+1%2F%28cos%280%29%2Bm*sin%280%29%29\n          Copy the solution into polar equation r = 1/(cos(t') + m*sin(t'))\n          where t' equals to mod(t, 2PI/X)\n         */\n\n        case 'diamond':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+1%2F%28cos%28mod+\n          // %28t%2C+PI%2F2%29%29%2Bsin%28mod+%28t%2C+PI%2F2%29%29%29%2C+t+%3D\n          // +0+..+2*PI\n          settings.shape = function shapeSquare (theta) {\n            var thetaPrime = theta % (2 * Math.PI / 4)\n            return 1 / (Math.cos(thetaPrime) + Math.sin(thetaPrime))\n          }\n          break\n\n        case 'square':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+min(1%2Fabs(cos(t\n          // )),1%2Fabs(sin(t)))),+t+%3D+0+..+2*PI\n          settings.shape = function shapeSquare (theta) {\n            return Math.min(\n              1 / Math.abs(Math.cos(theta)),\n              1 / Math.abs(Math.sin(theta))\n            )\n          }\n          break\n\n        case 'triangle-forward':\n          // http://www.wolframalpha.com/input/?i=plot+r+%3D+1%2F%28cos%28mod+\n          // %28t%2C+2*PI%2F3%29%29%2Bsqrt%283%29sin%28mod+%28t%2C+2*PI%2F3%29\n          // %29%29%2C+t+%3D+0+..+2*PI\n          settings.shape = function shapeTriangle (theta) {\n            var thetaPrime = theta % (2 * Math.PI / 3)\n            return 1 / (Math.cos(thetaPrime) +\n                        Math.sqrt(3) * Math.sin(thetaPrime))\n          }\n          break\n\n        case 'triangle':\n        case 'triangle-upright':\n          settings.shape = function shapeTriangle (theta) {\n            var thetaPrime = (theta + Math.PI * 3 / 2) % (2 * Math.PI / 3)\n            return 1 / (Math.cos(thetaPrime) +\n                        Math.sqrt(3) * Math.sin(thetaPrime))\n          }\n          break\n\n        case 'pentagon':\n          settings.shape = function shapePentagon (theta) {\n            var thetaPrime = (theta + 0.955) % (2 * Math.PI / 5)\n            return 1 / (Math.cos(thetaPrime) +\n                        0.726543 * Math.sin(thetaPrime))\n          }\n          break\n\n        case 'star':\n          settings.shape = function shapeStar (theta) {\n            var thetaPrime = (theta + 0.955) % (2 * Math.PI / 10)\n            if ((theta + 0.955) % (2 * Math.PI / 5) - (2 * Math.PI / 10) >= 0) {\n              return 1 / (Math.cos((2 * Math.PI / 10) - thetaPrime) +\n                          3.07768 * Math.sin((2 * Math.PI / 10) - thetaPrime))\n            } else {\n              return 1 / (Math.cos(thetaPrime) +\n                          3.07768 * Math.sin(thetaPrime))\n            }\n          }\n          break\n      }\n    }\n\n    /* Make sure gridSize is a whole number and is not smaller than 4px */\n    settings.gridSize = Math.max(Math.floor(settings.gridSize), 4)\n\n    /* shorthand */\n    var g = settings.gridSize\n    var maskRectWidth = g - settings.maskGapWidth\n\n    /* normalize rotation settings */\n    var rotationRange = Math.abs(settings.maxRotation - settings.minRotation)\n    var rotationSteps = Math.abs(Math.floor(settings.rotationSteps))\n    var minRotation = Math.min(settings.maxRotation, settings.minRotation)\n\n    /* information/object available to all functions, set when start() */\n    var grid, // 2d array containing filling information\n      ngx, ngy, // width and height of the grid\n      center, // position of the center of the cloud\n      maxRadius\n\n    /* timestamp for measuring each putWord() action */\n    var escapeTime\n\n    /* function for getting the color of the text */\n    var getTextColor\n    function randomHslColor (min, max) {\n      return 'hsl(' +\n        (Math.random() * 360).toFixed() + ',' +\n        (Math.random() * 30 + 70).toFixed() + '%,' +\n        (Math.random() * (max - min) + min).toFixed() + '%)'\n    }\n    switch (settings.color) {\n      case 'random-dark':\n        getTextColor = function getRandomDarkColor () {\n          return randomHslColor(10, 50)\n        }\n        break\n\n      case 'random-light':\n        getTextColor = function getRandomLightColor () {\n          return randomHslColor(50, 90)\n        }\n        break\n\n      default:\n        if (typeof settings.color === 'function') {\n          getTextColor = settings.color\n        }\n        break\n    }\n\n    /* function for getting the font-weight of the text */\n    var getTextFontWeight\n    if (typeof settings.fontWeight === 'function') {\n      getTextFontWeight = settings.fontWeight\n    }\n\n    /* function for getting the classes of the text */\n    var getTextClasses = null\n    if (typeof settings.classes === 'function') {\n      getTextClasses = settings.classes\n    }\n\n    /* Interactive */\n    var interactive = false\n    var infoGrid = []\n    var hovered\n\n    var getInfoGridFromMouseTouchEvent =\n    function getInfoGridFromMouseTouchEvent (evt) {\n      var canvas = evt.currentTarget\n      var rect = canvas.getBoundingClientRect()\n      var clientX\n      var clientY\n      /** Detect if touches are available */\n      if (evt.touches) {\n        clientX = evt.touches[0].clientX\n        clientY = evt.touches[0].clientY\n      } else {\n        clientX = evt.clientX\n        clientY = evt.clientY\n      }\n      var eventX = clientX - rect.left\n      var eventY = clientY - rect.top\n\n      var x = Math.floor(eventX * ((canvas.width / rect.width) || 1) / g)\n      var y = Math.floor(eventY * ((canvas.height / rect.height) || 1) / g)\n\n      return infoGrid[x][y]\n    }\n\n    var wordcloudhover = function wordcloudhover (evt) {\n      var info = getInfoGridFromMouseTouchEvent(evt)\n\n      if (hovered === info) {\n        return\n      }\n\n      hovered = info\n      if (!info) {\n        settings.hover(undefined, undefined, evt)\n\n        return\n      }\n\n      settings.hover(info.item, info.dimension, evt)\n    }\n\n    var wordcloudclick = function wordcloudclick (evt) {\n      var info = getInfoGridFromMouseTouchEvent(evt)\n      if (!info) {\n        return\n      }\n\n      settings.click(info.item, info.dimension, evt)\n      evt.preventDefault()\n    }\n\n    /* Get points on the grid for a given radius away from the center */\n    var pointsAtRadius = []\n    var getPointsAtRadius = function getPointsAtRadius (radius) {\n      if (pointsAtRadius[radius]) {\n        return pointsAtRadius[radius]\n      }\n\n      // Look for these number of points on each radius\n      var T = radius * 8\n\n      // Getting all the points at this radius\n      var t = T\n      var points = []\n\n      if (radius === 0) {\n        points.push([center[0], center[1], 0])\n      }\n\n      while (t--) {\n        // distort the radius to put the cloud in shape\n        var rx = 1\n        if (settings.shape !== 'circle') {\n          rx = settings.shape(t / T * 2 * Math.PI) // 0 to 1\n        }\n\n        // Push [x, y, t] t is used solely for getTextColor()\n        points.push([\n          center[0] + radius * rx * Math.cos(-t / T * 2 * Math.PI),\n          center[1] + radius * rx * Math.sin(-t / T * 2 * Math.PI) *\n            settings.ellipticity,\n          t / T * 2 * Math.PI])\n      }\n\n      pointsAtRadius[radius] = points\n      return points\n    }\n\n    /* Return true if we had spent too much time */\n    var exceedTime = function exceedTime () {\n      return ((settings.abortThreshold > 0) &&\n        ((new Date()).getTime() - escapeTime > settings.abortThreshold))\n    }\n\n    /* Get the deg of rotation according to settings, and luck. */\n    var getRotateDeg = function getRotateDeg () {\n      if (settings.rotateRatio === 0) {\n        return 0\n      }\n\n      if (Math.random() > settings.rotateRatio) {\n        return 0\n      }\n\n      if (rotationRange === 0) {\n        return minRotation\n      }\n\n      if (rotationSteps > 0) {\n        // Min rotation + zero or more steps * span of one step\n        return minRotation +\n          Math.floor(Math.random() * rotationSteps) *\n          rotationRange / (rotationSteps - 1)\n      } else {\n        return minRotation + Math.random() * rotationRange\n      }\n    }\n\n    var getTextInfo = function getTextInfo (word, weight, rotateDeg, extraDataArray) {\n      // calculate the acutal font size\n      // fontSize === 0 means weightFactor function wants the text skipped,\n      // and size < minSize means we cannot draw the text.\n      var debug = false\n      var fontSize = settings.weightFactor(weight)\n      if (fontSize <= settings.minSize) {\n        return false\n      }\n\n      // Scale factor here is to make sure fillText is not limited by\n      // the minium font size set by browser.\n      // It will always be 1 or 2n.\n      var mu = 1\n      if (fontSize < minFontSize) {\n        mu = (function calculateScaleFactor () {\n          var mu = 2\n          while (mu * fontSize < minFontSize) {\n            mu += 2\n          }\n          return mu\n        })()\n      }\n\n      // Get fontWeight that will be used to set fctx.font\n      var fontWeight\n      if (getTextFontWeight) {\n        fontWeight = getTextFontWeight(word, weight, fontSize, extraDataArray)\n      } else {\n        fontWeight = settings.fontWeight\n      }\n\n      var fcanvas = document.createElement('canvas')\n      var fctx = fcanvas.getContext('2d', { willReadFrequently: true })\n\n      fctx.font = fontWeight + ' ' +\n        (fontSize * mu).toString(10) + 'px ' + settings.fontFamily\n\n      // Estimate the dimension of the text with measureText().\n      var fw = fctx.measureText(word).width / mu\n      var fh = Math.max(fontSize * mu,\n        fctx.measureText('m').width,\n        fctx.measureText('\\uFF37').width\n      ) / mu\n\n      // Create a boundary box that is larger than our estimates,\n      // so text don't get cut of (it sill might)\n      var boxWidth = fw + fh * 2\n      var boxHeight = fh * 3\n      var fgw = Math.ceil(boxWidth / g)\n      var fgh = Math.ceil(boxHeight / g)\n      boxWidth = fgw * g\n      boxHeight = fgh * g\n\n      // Calculate the proper offsets to make the text centered at\n      // the preferred position.\n\n      // This is simply half of the width.\n      var fillTextOffsetX = -fw / 2\n      // Instead of moving the box to the exact middle of the preferred\n      // position, for Y-offset we move 0.4 instead, so Latin alphabets look\n      // vertical centered.\n      var fillTextOffsetY = -fh * 0.4\n\n      // Calculate the actual dimension of the canvas, considering the rotation.\n      var cgh = Math.ceil((boxWidth * Math.abs(Math.sin(rotateDeg)) +\n                           boxHeight * Math.abs(Math.cos(rotateDeg))) / g)\n      var cgw = Math.ceil((boxWidth * Math.abs(Math.cos(rotateDeg)) +\n                           boxHeight * Math.abs(Math.sin(rotateDeg))) / g)\n      var width = cgw * g\n      var height = cgh * g\n\n      fcanvas.setAttribute('width', width)\n      fcanvas.setAttribute('height', height)\n\n      if (debug) {\n        // Attach fcanvas to the DOM\n        document.body.appendChild(fcanvas)\n        // Save it's state so that we could restore and draw the grid correctly.\n        fctx.save()\n      }\n\n      // Scale the canvas with |mu|.\n      fctx.scale(1 / mu, 1 / mu)\n      fctx.translate(width * mu / 2, height * mu / 2)\n      fctx.rotate(-rotateDeg)\n\n      // Once the width/height is set, ctx info will be reset.\n      // Set it again here.\n      fctx.font = fontWeight + ' ' +\n        (fontSize * mu).toString(10) + 'px ' + settings.fontFamily\n\n      // Fill the text into the fcanvas.\n      // XXX: We cannot because textBaseline = 'top' here because\n      // Firefox and Chrome uses different default line-height for canvas.\n      // Please read https://bugzil.la/737852#c6.\n      // Here, we use textBaseline = 'middle' and draw the text at exactly\n      // 0.5 * fontSize lower.\n      fctx.fillStyle = '#000'\n      fctx.textBaseline = 'middle'\n      fctx.fillText(\n        word, fillTextOffsetX * mu,\n        (fillTextOffsetY + fontSize * 0.5) * mu\n      )\n\n      // Get the pixels of the text\n      var imageData = fctx.getImageData(0, 0, width, height).data\n\n      if (exceedTime()) {\n        return false\n      }\n\n      if (debug) {\n        // Draw the box of the original estimation\n        fctx.strokeRect(\n          fillTextOffsetX * mu,\n          fillTextOffsetY, fw * mu, fh * mu\n        )\n        fctx.restore()\n      }\n\n      // Read the pixels and save the information to the occupied array\n      var occupied = []\n      var gx = cgw\n      var gy, x, y\n      var bounds = [cgh / 2, cgw / 2, cgh / 2, cgw / 2]\n      while (gx--) {\n        gy = cgh\n        while (gy--) {\n          y = g\n          /* eslint no-labels: [\"error\", { \"allowLoop\": true }] */\n          singleGridLoop: while (y--) {\n            x = g\n            while (x--) {\n              if (imageData[((gy * g + y) * width +\n                (gx * g + x)) * 4 + 3]) {\n                occupied.push([gx, gy])\n\n                if (gx < bounds[3]) {\n                  bounds[3] = gx\n                }\n                if (gx > bounds[1]) {\n                  bounds[1] = gx\n                }\n                if (gy < bounds[0]) {\n                  bounds[0] = gy\n                }\n                if (gy > bounds[2]) {\n                  bounds[2] = gy\n                }\n\n                if (debug) {\n                  fctx.fillStyle = 'rgba(255, 0, 0, 0.5)'\n                  fctx.fillRect(gx * g, gy * g, g - 0.5, g - 0.5)\n                }\n                break singleGridLoop\n              }\n            }\n          }\n          if (debug) {\n            fctx.fillStyle = 'rgba(0, 0, 255, 0.5)'\n            fctx.fillRect(gx * g, gy * g, g - 0.5, g - 0.5)\n          }\n        }\n      }\n\n      if (debug) {\n        fctx.fillStyle = 'rgba(0, 255, 0, 0.5)'\n        fctx.fillRect(\n          bounds[3] * g,\n          bounds[0] * g,\n          (bounds[1] - bounds[3] + 1) * g,\n          (bounds[2] - bounds[0] + 1) * g\n        )\n      }\n\n      // Return information needed to create the text on the real canvas\n      return {\n        mu: mu,\n        occupied: occupied,\n        bounds: bounds,\n        gw: cgw,\n        gh: cgh,\n        fillTextOffsetX: fillTextOffsetX,\n        fillTextOffsetY: fillTextOffsetY,\n        fillTextWidth: fw,\n        fillTextHeight: fh,\n        fontSize: fontSize\n      }\n    }\n\n    /* Determine if there is room available in the given dimension */\n    var canFitText = function canFitText (gx, gy, gw, gh, occupied) {\n      // Go through the occupied points,\n      // return false if the space is not available.\n      var i = occupied.length\n      while (i--) {\n        var px = gx + occupied[i][0]\n        var py = gy + occupied[i][1]\n\n        if (px >= ngx || py >= ngy || px < 0 || py < 0) {\n          if (!settings.drawOutOfBound) {\n            return false\n          }\n          continue\n        }\n\n        if (!grid[px][py]) {\n          return false\n        }\n      }\n      return true\n    }\n\n    /* Actually draw the text on the grid */\n    var drawText = function drawText (gx, gy, info, word, weight, distance, theta, rotateDeg, attributes, extraDataArray) {\n      var fontSize = info.fontSize\n      var color\n      if (getTextColor) {\n        color = getTextColor(word, weight, fontSize, distance, theta, extraDataArray)\n      } else {\n        color = settings.color\n      }\n\n      // get fontWeight that will be used to set ctx.font and font style rule\n      var fontWeight\n      if (getTextFontWeight) {\n        fontWeight = getTextFontWeight(word, weight, fontSize, extraDataArray)\n      } else {\n        fontWeight = settings.fontWeight\n      }\n\n      var classes\n      if (getTextClasses) {\n        classes = getTextClasses(word, weight, fontSize, extraDataArray)\n      } else {\n        classes = settings.classes\n      }\n\n      elements.forEach(function (el) {\n        if (el.getContext) {\n          var ctx = el.getContext('2d')\n          var mu = info.mu\n\n          // Save the current state before messing it\n          ctx.save()\n          ctx.scale(1 / mu, 1 / mu)\n\n          ctx.font = fontWeight + ' ' +\n                     (fontSize * mu).toString(10) + 'px ' + settings.fontFamily\n          ctx.fillStyle = color\n\n          // Translate the canvas position to the origin coordinate of where\n          // the text should be put.\n          ctx.translate(\n            (gx + info.gw / 2) * g * mu,\n            (gy + info.gh / 2) * g * mu\n          )\n\n          if (rotateDeg !== 0) {\n            ctx.rotate(-rotateDeg)\n          }\n\n          // Finally, fill the text.\n\n          // XXX: We cannot because textBaseline = 'top' here because\n          // Firefox and Chrome uses different default line-height for canvas.\n          // Please read https://bugzil.la/737852#c6.\n          // Here, we use textBaseline = 'middle' and draw the text at exactly\n          // 0.5 * fontSize lower.\n          ctx.textBaseline = 'middle'\n          ctx.fillText(\n            word, info.fillTextOffsetX * mu,\n            (info.fillTextOffsetY + fontSize * 0.5) * mu\n          )\n\n          // The below box is always matches how <span>s are positioned\n          /* ctx.strokeRect(info.fillTextOffsetX, info.fillTextOffsetY,\n            info.fillTextWidth, info.fillTextHeight) */\n\n          // Restore the state.\n          ctx.restore()\n        } else {\n          // drawText on DIV element\n          var span = document.createElement('span')\n          var transformRule = ''\n          transformRule = 'rotate(' + (-rotateDeg / Math.PI * 180) + 'deg) '\n          if (info.mu !== 1) {\n            transformRule +=\n              'translateX(-' + (info.fillTextWidth / 4) + 'px) ' +\n              'scale(' + (1 / info.mu) + ')'\n          }\n          var styleRules = {\n            position: 'absolute',\n            display: 'block',\n            font: fontWeight + ' ' +\n              (fontSize * info.mu) + 'px ' + settings.fontFamily,\n            left: ((gx + info.gw / 2) * g + info.fillTextOffsetX) + 'px',\n            top: ((gy + info.gh / 2) * g + info.fillTextOffsetY) + 'px',\n            width: info.fillTextWidth + 'px',\n            height: info.fillTextHeight + 'px',\n            lineHeight: fontSize + 'px',\n            whiteSpace: 'nowrap',\n            transform: transformRule,\n            webkitTransform: transformRule,\n            msTransform: transformRule,\n            transformOrigin: '50% 40%',\n            webkitTransformOrigin: '50% 40%',\n            msTransformOrigin: '50% 40%'\n          }\n          if (color) {\n            styleRules.color = color\n          }\n          span.textContent = word\n          for (var cssProp in styleRules) {\n            span.style[cssProp] = styleRules[cssProp]\n          }\n          if (attributes) {\n            for (var attribute in attributes) {\n              span.setAttribute(attribute, attributes[attribute])\n            }\n          }\n          if (classes) {\n            span.className += classes\n          }\n          el.appendChild(span)\n        }\n      })\n    }\n\n    /* Help function to updateGrid */\n    var fillGridAt = function fillGridAt (x, y, drawMask, dimension, item) {\n      if (x >= ngx || y >= ngy || x < 0 || y < 0) {\n        return\n      }\n\n      grid[x][y] = false\n\n      if (drawMask) {\n        var ctx = elements[0].getContext('2d')\n        ctx.fillRect(x * g, y * g, maskRectWidth, maskRectWidth)\n      }\n\n      if (interactive) {\n        infoGrid[x][y] = { item: item, dimension: dimension }\n      }\n    }\n\n    /* Update the filling information of the given space with occupied points.\n       Draw the mask on the canvas if necessary. */\n    var updateGrid = function updateGrid (gx, gy, gw, gh, info, item) {\n      var occupied = info.occupied\n      var drawMask = settings.drawMask\n      var ctx\n      if (drawMask) {\n        ctx = elements[0].getContext('2d')\n        ctx.save()\n        ctx.fillStyle = settings.maskColor\n      }\n\n      var dimension\n      if (interactive) {\n        var bounds = info.bounds\n        dimension = {\n          x: (gx + bounds[3]) * g,\n          y: (gy + bounds[0]) * g,\n          w: (bounds[1] - bounds[3] + 1) * g,\n          h: (bounds[2] - bounds[0] + 1) * g\n        }\n      }\n\n      var i = occupied.length\n      while (i--) {\n        var px = gx + occupied[i][0]\n        var py = gy + occupied[i][1]\n\n        if (px >= ngx || py >= ngy || px < 0 || py < 0) {\n          continue\n        }\n\n        fillGridAt(px, py, drawMask, dimension, item)\n      }\n\n      if (drawMask) {\n        ctx.restore()\n      }\n    }\n\n    /* putWord() processes each item on the list,\n       calculate it's size and determine it's position, and actually\n       put it on the canvas. */\n    var putWord = function putWord (item) {\n      var word, weight, attributes\n      if (Array.isArray(item)) {\n        word = item[0]\n        weight = item[1]\n      } else {\n        word = item.word\n        weight = item.weight\n        attributes = item.attributes\n      }\n      var rotateDeg = getRotateDeg()\n\n      var extraDataArray = getItemExtraData(item)\n\n      // get info needed to put the text onto the canvas\n      var info = getTextInfo(word, weight, rotateDeg, extraDataArray)\n\n      // not getting the info means we shouldn't be drawing this one.\n      if (!info) {\n        return false\n      }\n\n      if (exceedTime()) {\n        return false\n      }\n\n      // If drawOutOfBound is set to false,\n      // skip the loop if we have already know the bounding box of\n      // word is larger than the canvas.\n      if (!settings.drawOutOfBound && !settings.shrinkToFit) {\n        var bounds = info.bounds;\n        if ((bounds[1] - bounds[3] + 1) > ngx ||\n          (bounds[2] - bounds[0] + 1) > ngy) {\n          return false\n        }\n      }\n\n      // Determine the position to put the text by\n      // start looking for the nearest points\n      var r = maxRadius + 1\n\n      var tryToPutWordAtPoint = function (gxy) {\n        var gx = Math.floor(gxy[0] - info.gw / 2)\n        var gy = Math.floor(gxy[1] - info.gh / 2)\n        var gw = info.gw\n        var gh = info.gh\n\n        // If we cannot fit the text at this position, return false\n        // and go to the next position.\n        if (!canFitText(gx, gy, gw, gh, info.occupied)) {\n          return false\n        }\n\n        // Actually put the text on the canvas\n        drawText(gx, gy, info, word, weight,\n          (maxRadius - r), gxy[2], rotateDeg, attributes, extraDataArray)\n\n        // Mark the spaces on the grid as filled\n        updateGrid(gx, gy, gw, gh, info, item)\n\n        // Return true so some() will stop and also return true.\n        return true\n      }\n\n      while (r--) {\n        var points = getPointsAtRadius(maxRadius - r)\n\n        if (settings.shuffle) {\n          points = [].concat(points)\n          shuffleArray(points)\n        }\n\n        // Try to fit the words by looking at each point.\n        // array.some() will stop and return true\n        // when putWordAtPoint() returns true.\n        // If all the points returns false, array.some() returns false.\n        var drawn = points.some(tryToPutWordAtPoint)\n\n        if (drawn) {\n          // leave putWord() and return true\n          return true\n        }\n      }\n      if (settings.shrinkToFit) {\n        if (Array.isArray(item)) {\n          item[1] = item[1] * 3 / 4\n        } else {\n          item.weight = item.weight * 3 / 4\n        }\n        return putWord(item)\n      }\n      // we tried all distances but text won't fit, return false\n      return false\n    }\n\n    /* Send DOM event to all elements. Will stop sending event and return\n       if the previous one is canceled (for cancelable events). */\n    var sendEvent = function sendEvent (type, cancelable, details) {\n      if (cancelable) {\n        return !elements.some(function (el) {\n          var event = new CustomEvent(type, {\n            detail: details || {}\n          })\n          return !el.dispatchEvent(event)\n        }, this)\n      } else {\n        elements.forEach(function (el) {\n          var event = new CustomEvent(type, {\n            detail: details || {}\n          })\n          el.dispatchEvent(event)\n        }, this)\n      }\n    }\n\n    /* Start drawing on a canvas */\n    var start = function start () {\n      // For dimensions, clearCanvas etc.,\n      // we only care about the first element.\n      var canvas = elements[0]\n\n      if (canvas.getContext) {\n        ngx = Math.ceil(canvas.width / g)\n        ngy = Math.ceil(canvas.height / g)\n      } else {\n        var rect = canvas.getBoundingClientRect()\n        ngx = Math.ceil(rect.width / g)\n        ngy = Math.ceil(rect.height / g)\n      }\n\n      // Sending a wordcloudstart event which cause the previous loop to stop.\n      // Do nothing if the event is canceled.\n      if (!sendEvent('wordcloudstart', true)) {\n        return\n      }\n\n      // Determine the center of the word cloud\n      center = (settings.origin)\n        ? [settings.origin[0] / g, settings.origin[1] / g]\n        : [ngx / 2, ngy / 2]\n\n      // Maxium radius to look for space\n      maxRadius = Math.floor(Math.sqrt(ngx * ngx + ngy * ngy))\n\n      /* Clear the canvas only if the clearCanvas is set,\n         if not, update the grid to the current canvas state */\n      grid = []\n\n      var gx, gy, i\n      if (!canvas.getContext || settings.clearCanvas) {\n        elements.forEach(function (el) {\n          if (el.getContext) {\n            var ctx = el.getContext('2d')\n            ctx.fillStyle = settings.backgroundColor\n            ctx.clearRect(0, 0, ngx * (g + 1), ngy * (g + 1))\n            ctx.fillRect(0, 0, ngx * (g + 1), ngy * (g + 1))\n          } else {\n            el.textContent = ''\n            el.style.backgroundColor = settings.backgroundColor\n            el.style.position = 'relative'\n          }\n        })\n\n        /* fill the grid with empty state */\n        gx = ngx\n        while (gx--) {\n          grid[gx] = []\n          gy = ngy\n          while (gy--) {\n            grid[gx][gy] = true\n          }\n        }\n      } else {\n        /* Determine bgPixel by creating\n           another canvas and fill the specified background color. */\n        var bctx = document.createElement('canvas').getContext('2d')\n\n        bctx.fillStyle = settings.backgroundColor\n        bctx.fillRect(0, 0, 1, 1)\n        var bgPixel = bctx.getImageData(0, 0, 1, 1).data\n\n        /* Read back the pixels of the canvas we got to tell which part of the\n           canvas is empty.\n           (no clearCanvas only works with a canvas, not divs) */\n        var imageData =\n          canvas.getContext('2d').getImageData(0, 0, ngx * g, ngy * g).data\n\n        gx = ngx\n        var x, y\n        while (gx--) {\n          grid[gx] = []\n          gy = ngy\n          while (gy--) {\n            y = g\n            /* eslint no-labels: [\"error\", { \"allowLoop\": true }] */\n            singleGridLoop: while (y--) {\n              x = g\n              while (x--) {\n                i = 4\n                while (i--) {\n                  if (imageData[((gy * g + y) * ngx * g +\n                                 (gx * g + x)) * 4 + i] !== bgPixel[i]) {\n                    grid[gx][gy] = false\n                    break singleGridLoop\n                  }\n                }\n              }\n            }\n            if (grid[gx][gy] !== false) {\n              grid[gx][gy] = true\n            }\n          }\n        }\n\n        imageData = bctx = bgPixel = undefined\n      }\n\n      // fill the infoGrid with empty state if we need it\n      if (settings.hover || settings.click) {\n        interactive = true\n\n        /* fill the grid with empty state */\n        gx = ngx + 1\n        while (gx--) {\n          infoGrid[gx] = []\n        }\n\n        if (settings.hover) {\n          canvas.addEventListener('mousemove', wordcloudhover)\n        }\n\n        if (settings.click) {\n          canvas.addEventListener('click', wordcloudclick)\n          canvas.style.webkitTapHighlightColor = 'rgba(0, 0, 0, 0)'\n        }\n\n        canvas.addEventListener('wordcloudstart', function stopInteraction () {\n          canvas.removeEventListener('wordcloudstart', stopInteraction)\n          canvas.removeEventListener('mousemove', wordcloudhover)\n          canvas.removeEventListener('click', wordcloudclick)\n          hovered = undefined\n        })\n      }\n\n      i = 0\n      var loopingFunction, stoppingFunction\n      if (settings.wait !== 0) {\n        loopingFunction = window.setTimeout\n        stoppingFunction = window.clearTimeout\n      } else {\n        loopingFunction = window.setImmediate\n        stoppingFunction = window.clearImmediate\n      }\n\n      var addEventListener = function addEventListener (type, listener) {\n        elements.forEach(function (el) {\n          el.addEventListener(type, listener)\n        }, this)\n      }\n\n      var removeEventListener = function removeEventListener (type, listener) {\n        elements.forEach(function (el) {\n          el.removeEventListener(type, listener)\n        }, this)\n      }\n\n      var anotherWordCloudStart = function anotherWordCloudStart () {\n        removeEventListener('wordcloudstart', anotherWordCloudStart)\n        stoppingFunction(timer[timerId])\n      }\n\n      addEventListener('wordcloudstart', anotherWordCloudStart)\n      timer[timerId] = loopingFunction(function loop () {\n        if (i >= settings.list.length) {\n          stoppingFunction(timer[timerId])\n          sendEvent('wordcloudstop', false)\n          removeEventListener('wordcloudstart', anotherWordCloudStart)\n          delete timer[timerId];\n          return\n        }\n        escapeTime = (new Date()).getTime()\n        var drawn = putWord(settings.list[i])\n        var canceled = !sendEvent('wordclouddrawn', true, {\n          item: settings.list[i],\n          drawn: drawn\n        })\n        if (exceedTime() || canceled) {\n          stoppingFunction(timer[timerId])\n          settings.abort()\n          sendEvent('wordcloudabort', false)\n          sendEvent('wordcloudstop', false)\n          removeEventListener('wordcloudstart', anotherWordCloudStart)\n          delete timer[timerId]\n          return\n        }\n        i++\n        timer[timerId] = loopingFunction(loop, settings.wait)\n      }, settings.wait)\n    }\n\n    // All set, start the drawing\n    start()\n  }\n\n  WordCloud.isSupported = isSupported\n  WordCloud.minFontSize = minFontSize\n  WordCloud.stop = function stop () {\n    if (timer) {\n      for (var timerId in timer) {\n        window.clearImmediate(timer[timerId])\n      }\n    }\n  }\n  debugger;\n  // Expose the library as an AMD module\n  if (typeof define === 'function' && define.amd) { // eslint-disable-line no-undef\n    global.WordCloud = WordCloud\n    define('wordcloud', [], function () { return WordCloud }) // eslint-disable-line no-undef\n  } else if (typeof module !== 'undefined' && module.exports) { // eslint-disable-line no-undef\n    module.exports = WordCloud // eslint-disable-line no-undef\n  } else {\n    global.WordCloud = WordCloud\n  }\n})(this) // jshint ignore:line\n"]}